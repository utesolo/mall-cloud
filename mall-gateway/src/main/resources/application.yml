spring:
  application:
    name: mall-gateway
  config:
    import: optional:nacos:${spring.application.name}.yml
  profiles:
    active: local
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
    gateway:
      server:
        webflux:
          routes:
            # Auth Service
            - id: mall-auth
              uri: lb://mall-auth
              predicates:
                - Path=/auth/**
            # Product Service
            - id: mall-product
              uri: lb://mall-product
              predicates:
                - Path=/product/**
            # File Service
            - id: mall-file
              uri: lb://mall-file
              predicates:
                - Path=/file/**
            # Trade Service - Order
            - id: mall-trade-order
              uri: lb://mall-trade
              predicates:
                - Path=/order/**
            # Trade Service - Planting Plan
            - id: mall-trade-planting-plan
              uri: lb://mall-trade
              predicates:
                - Path=/planting-plan/**
            # Trade Service - Matching
            - id: mall-trade-match
              uri: lb://mall-trade
              predicates:
                - Path=/match/**
            # Trade Service - Tracking
            - id: mall-trade-tracking
              uri: lb://mall-trade
              predicates:
                - Path=/tracking/**
            # Search Service
            - id: mall-search
              uri: lb://mall-search
              predicates:
                - Path=/search/**

server:
  port: 8080

# Zipkin tracing configuration
management:
  tracing:
    sampling:
      probability: 0.1
  zipkin:
    tracing:
      endpoint: http://localhost:9411/api/v2/spans

# Custom tracing configuration
tracing:
  enabled: true
  default-probability: 0.1
  important-probability: 1.0
  important-paths:
    - /order
    - /payment
    - /match
    - /auth/login
  ignore-paths:
    - /actuator
    - /health
    - /favicon

logging:
  level:
    xyh.dp.mall: debug
